<div class="popular-projects">
  <div class="container">
    <h2 class="section-title">Dự án nhà đất <span class="highlight">nổi bật</span></h2>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-container">
      <div class="loading">
        <div class="spinner"></div>
        <p>Đang tải dự án nổi bật...</p>
      </div>
    </div>    <!-- Grid Layout -->
    <div class="projects-grid" 
         [ngClass]="getGridClass()" 
         *ngIf="!loading && !error && popularProducts.length > 0">
      <div class="project-card" 
           *ngFor="let product of popularProducts; let i = index" 
           [class.featured]="i === 0 && popularProducts.length === 1"
           (click)="viewDetails(product.id)">
        <div class="project-image">
          <img [src]="'https://lh3.googleusercontent.com/d/' + getMainImage(product)"
               [alt]="product.name"
               onerror="this.src='assets/images/default_property.jpeg'">
          <div class="project-overlay">
            <div class="project-title">{{product.name}}</div>
            <div class="project-location">{{product.address_detail.address}}</div>
          </div>
          <span class="project-type" [class.sale]="product.product_detail.type_product === 'sale'"
                [class.rent]="product.product_detail.type_product === 'rent'"
                [class.project]="product.category_id === 7">
            {{product.product_detail.type_product === 'sale' ? 'Bán' :
               product.product_detail.type_product === 'rent' ? 'Cho thuê' : 'Dự án'}}
          </span>
          <span class="hot-badge" *ngIf="i < 3">HOT</span>
        </div>
      </div>
    </div>

    <!-- No Results -->
    <div *ngIf="!loading && !error && popularProducts.length === 0" class="no-results">
      <i class="fas fa-search"></i>
      <h2>Không có dự án nổi bật</h2>
      <p>Vui lòng quay lại sau</p>
    </div>
  </div>
</div>
